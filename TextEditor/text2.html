<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Page Title</title>
    <meta name="viewport" content="width-device-width", initial-scale="1">
    <!-- 공식 사이트에 있는 코드는 아니고 어떤 사람이 추가한 CSS 코드 -->
    <style>
        * {
            text-align: center;
        }
        #editor {
            border: 1px solid;
            width: 50%;
            margin: 0 auto;
        }
    </style>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.48.4/codemirror.min.css"/>
    <link rel="stylesheet" href="https://uicdn.toast.com/editor/latest/toastui-editor.min.css" />
</head>
<body>
    <h1>Toast UI Editor 만들기</h1>
    <!-- 에디터가 들어갈 div 태그 -->
    <div id="editor"></div>
    <button id="submitBtn">작성완료</button>

    <script src="https://uicdn.toast.com/editor/latest/toastui-editor-all.min.js"></script>

    <script>
        const editor = new toastui.Editor({
            el: document.querySelector('#editor'),
            previewStyle: 'vertical',
            height: '500px',
            initialValue: '안녕? 이건 내가 만든 텍스트 에디터야'
        });

        // 데이터를 서버로 전송
        function sendDataToServer() {
            const dataToSend = {
                content: editor.getMarkdown()
            };

        /* 
        function sendDataToServer()
        : 사용자가 작성한 데이터를 서버로 보내는 역할

        const dataTosend = {content: editor.getMarkdown()}
        : 변수를 선언 후 객체 생성 <-- 서버로 보낼 데이터를 담는 역할
        
        editor.getMarkdown()
        : toast ui ediotr에서 현재 편집 중인 텍스트를 마크다운 형식으로 반환해줌
        */

            fetch('/submitData', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(dataToSend)
            })
/*
            fetch ~ ~
            # fetch() -> 데이터를 서버로 보내는 요청
            # /submiData -> 요청을 보낼 URL
            # method -> 요청 메서드를 POST로 하겠음
            # headers { 'Content-Type': 'application/json' }
              : Content-Type을 json으로 하겠다
              : 본문 형식이 json 형식이라고 알려주는 역할
            # body: JSON.stringify(dataToSend)
              : dataSend 객체를 json 형식의 문자열로 변환
*/
            // .then(), .catch()는 js의 promis객체를 사용하여 비동기 코드를 처리하는 방법 (챗gpt)
            // http 요청 응답을 받았을 때 응답을 텍스트로 변환 후 .hten()으로 전달
            .then(response => response.text())

            // 텍스트로 변환된 응답을 받으면 콘솔에 출력
            .then(data => console.log(data))

            // http요청이 실패하거나 오류 발생시 오류 처리
            .catch(error => console.error('Error:', error));
        }

        // 버튼 클릭 시 데이터 전송
        document.getElementById('submitBtn').addEventListener('click', sendDataToServer);
    </script>
</body>
</html>
